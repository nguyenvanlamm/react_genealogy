import React, { useEffect, useState } from "react";
import "./related.css";
import ItemNewsRelated from "./ItemNewsRelated";
import { NewModel } from "src/app/models/models";
import { useNews } from "src/app/stores/hooks";

const NewsRelated = (props: { data: NewModel }) => {
  const [isNewsRelated, setIsNewsRelated] = useState(false);
  const [news, getNews] = useNews();
  const [newsCategories, SetNewsCategories] = useState<NewModel[]>([{
    id: 1,
    newsCategoryId: 1,
    title: "Gia phả họ Kiều",
    content: "<div>Hello</div>",
    description: "Hello",
    imageUrl: "https://phuongnam24h.com/img_data/images/lich-su-trung-quoc-thoi-co-dai.jpg",
    date: "20-02-2024",
    comments: 1,
  }
  ]);

  const [newsTag, SetNewsTags] = useState<NewModel[]>([{
    id: 1,
    newsCategoryId: 1,
    title: "Gia phả họ Kiều",
    content: "<div>Hello</div>",
    description: "Hello",
    imageUrl: "https://phuongnam24h.com/img_data/images/lich-su-trung-quoc-thoi-co-dai.jpg",
    date: "20-02-2024",
    comments: 1,
  }
  ]);

  useEffect(() => {
    if (news.length <= 0) {
      getNews();
    } else {
      UpdateDataNews();
    }
  }, []);

  useEffect(() => {
    if (news.length > 0) {
      UpdateDataNews();
      UpdateDataNewTags();
    }
  }, [news]);

  const UpdateDataNews = () => {
    const data: NewModel[] = [];
    news.forEach(item => {
      if (item.newsCategoryId == props.data.newsCategoryId) {
        data.push(item);
      }
    });

    SetNewsCategories(data);
  }

  const UpdateDataNewTags = () => {
    const data: NewModel[] = [];
    news.forEach(item => {
      var isSameTags = false;
      props.data.tagId.map((itemTag) => {
        if(item.tagId.includes(itemTag)){
          isSameTags = true;
        }
      });

      if(isSameTags){
        data.push(item);
      }
    });

    SetNewsTags(data);
  }

  return (
    <div className="flex flex-col relative">
      <div className="justify-center items-center w-full pb-[10%] p-[24px]">
        <div className="flex place-content-center flex-row gap-[32px]">
          <div className="flex flex-col gap-[8px]">
            <div
              onClick={() => setIsNewsRelated(false)}
              className="cursor-pointer text-center averta-semibold font-semibold sm:text-[20px] text-[16px] leading-[24px]"
            >
              CÙNG MỤC
            </div>
            {isNewsRelated === false && (
              <div className="w-full flex justify-center items-center">
                <svg
                  width="80"
                  height="6"
                  viewBox="0 0 80 6"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <g clip-path="url(#clip0_119_8681)">
                    <path
                      d="M9.15429 3.30003V5.45703H5.64346V3.00559H7.30255V3.80236H6.44976V4.66025H8.34862V2.10115H5.93194V0.796773H0.804401V5.20261H3.78761V3.16848H2.33033V2.37139H4.59264V6H0V0H6.73792V1.3022H9.15429V2.50264H10.9086V1.8098H10.0552V1.01117H11.7136V3.30003H9.15429Z"
                      fill="#9E2B25"
                    />
                    <path
                      d="M20.4068 6V2.37139H22.6688V3.16848H21.2118V5.20261H24.1941V0.796773H19.0672V2.10115H16.6511V4.66025H18.5491V3.80236H17.6963V3.00559H19.355V5.45703H15.8461V3.30003H13.2861V1.01117H14.9443V1.8098H14.0905V2.50264H15.8461V1.3022H18.2618V0H24.9998V6H20.4068Z"
                      fill="#9E2B25"
                    />
                  </g>
                  <g clip-path="url(#clip1_119_8681)">
                    <path
                      d="M36.1543 3.30003V5.45703H32.6435V3.00559H34.3026V3.80236H33.4498V4.66025H35.3486V2.10115H32.9319V0.796773H27.8044V5.20261H30.7876V3.16848H29.3303V2.37139H31.5926V6H27V0H33.7379V1.3022H36.1543V2.50264H37.9086V1.8098H37.0552V1.01117H38.7136V3.30003H36.1543Z"
                      fill="#9E2B25"
                    />
                    <path
                      d="M47.4068 6V2.37139H49.6688V3.16848H48.2118V5.20261H51.1941V0.796773H46.0672V2.10115H43.6511V4.66025H45.5491V3.80236H44.6963V3.00559H46.355V5.45703H42.8461V3.30003H40.2861V1.01117H41.9443V1.8098H41.0905V2.50264H42.8461V1.3022H45.2618V0H51.9998V6H47.4068Z"
                      fill="#9E2B25"
                    />
                  </g>
                  <g clip-path="url(#clip2_119_8681)">
                    <path
                      d="M64.1543 3.30003V5.45703H60.6435V3.00559H62.3026V3.80236H61.4498V4.66025H63.3486V2.10115H60.9319V0.796773H55.8044V5.20261H58.7876V3.16848H57.3303V2.37139H59.5926V6H55V0H61.7379V1.3022H64.1543V2.50264H65.9086V1.8098H65.0552V1.01117H66.7136V3.30003H64.1543Z"
                      fill="#9E2B25"
                    />
                    <path
                      d="M75.4068 6V2.37139H77.6688V3.16848H76.2118V5.20261H79.1941V0.796773H74.0672V2.10115H71.6511V4.66025H73.5491V3.80236H72.6963V3.00559H74.355V5.45703H70.8461V3.30003H68.2861V1.01117H69.9443V1.8098H69.0905V2.50264H70.8461V1.3022H73.2618V0H79.9998V6H75.4068Z"
                      fill="#9E2B25"
                    />
                  </g>
                  <defs>
                    <clipPath id="clip0_119_8681">
                      <rect width="25" height="6" fill="white" />
                    </clipPath>
                    <clipPath id="clip1_119_8681">
                      <rect
                        width="25"
                        height="6"
                        fill="white"
                        transform="translate(27)"
                      />
                    </clipPath>
                    <clipPath id="clip2_119_8681">
                      <rect
                        width="25"
                        height="6"
                        fill="white"
                        transform="translate(55)"
                      />
                    </clipPath>
                  </defs>
                </svg>
              </div>
            )}
          </div>
          <div className="flex flex-col gap-[8px]">
            <div
              onClick={() => setIsNewsRelated(true)}
              className="cursor-pointer text-center averta-semibold font-semibold sm:text-[20px] text-[16px] leading-[24px]"
            >
              TIN LIÊN QUAN
            </div>
            {isNewsRelated === true && (
              <div className="w-full flex justify-center items-center">
                <svg
                  width="80"
                  height="6"
                  viewBox="0 0 80 6"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <g clip-path="url(#clip0_119_8681)">
                    <path
                      d="M9.15429 3.30003V5.45703H5.64346V3.00559H7.30255V3.80236H6.44976V4.66025H8.34862V2.10115H5.93194V0.796773H0.804401V5.20261H3.78761V3.16848H2.33033V2.37139H4.59264V6H0V0H6.73792V1.3022H9.15429V2.50264H10.9086V1.8098H10.0552V1.01117H11.7136V3.30003H9.15429Z"
                      fill="#9E2B25"
                    />
                    <path
                      d="M20.4068 6V2.37139H22.6688V3.16848H21.2118V5.20261H24.1941V0.796773H19.0672V2.10115H16.6511V4.66025H18.5491V3.80236H17.6963V3.00559H19.355V5.45703H15.8461V3.30003H13.2861V1.01117H14.9443V1.8098H14.0905V2.50264H15.8461V1.3022H18.2618V0H24.9998V6H20.4068Z"
                      fill="#9E2B25"
                    />
                  </g>
                  <g clip-path="url(#clip1_119_8681)">
                    <path
                      d="M36.1543 3.30003V5.45703H32.6435V3.00559H34.3026V3.80236H33.4498V4.66025H35.3486V2.10115H32.9319V0.796773H27.8044V5.20261H30.7876V3.16848H29.3303V2.37139H31.5926V6H27V0H33.7379V1.3022H36.1543V2.50264H37.9086V1.8098H37.0552V1.01117H38.7136V3.30003H36.1543Z"
                      fill="#9E2B25"
                    />
                    <path
                      d="M47.4068 6V2.37139H49.6688V3.16848H48.2118V5.20261H51.1941V0.796773H46.0672V2.10115H43.6511V4.66025H45.5491V3.80236H44.6963V3.00559H46.355V5.45703H42.8461V3.30003H40.2861V1.01117H41.9443V1.8098H41.0905V2.50264H42.8461V1.3022H45.2618V0H51.9998V6H47.4068Z"
                      fill="#9E2B25"
                    />
                  </g>
                  <g clip-path="url(#clip2_119_8681)">
                    <path
                      d="M64.1543 3.30003V5.45703H60.6435V3.00559H62.3026V3.80236H61.4498V4.66025H63.3486V2.10115H60.9319V0.796773H55.8044V5.20261H58.7876V3.16848H57.3303V2.37139H59.5926V6H55V0H61.7379V1.3022H64.1543V2.50264H65.9086V1.8098H65.0552V1.01117H66.7136V3.30003H64.1543Z"
                      fill="#9E2B25"
                    />
                    <path
                      d="M75.4068 6V2.37139H77.6688V3.16848H76.2118V5.20261H79.1941V0.796773H74.0672V2.10115H71.6511V4.66025H73.5491V3.80236H72.6963V3.00559H74.355V5.45703H70.8461V3.30003H68.2861V1.01117H69.9443V1.8098H69.0905V2.50264H70.8461V1.3022H73.2618V0H79.9998V6H75.4068Z"
                      fill="#9E2B25"
                    />
                  </g>
                  <defs>
                    <clipPath id="clip0_119_8681">
                      <rect width="25" height="6" fill="white" />
                    </clipPath>
                    <clipPath id="clip1_119_8681">
                      <rect
                        width="25"
                        height="6"
                        fill="white"
                        transform="translate(27)"
                      />
                    </clipPath>
                    <clipPath id="clip2_119_8681">
                      <rect
                        width="25"
                        height="6"
                        fill="white"
                        transform="translate(55)"
                      />
                    </clipPath>
                  </defs>
                </svg>
              </div>
            )}
          </div>
        </div>
        <div className="w-full overflow-auto h-[680px]">
          {isNewsRelated == false && (
            <ItemNewsRelated listNews={newsCategories}></ItemNewsRelated>
          )}
          {isNewsRelated == true && (
            <ItemNewsRelated listNews={newsTag}></ItemNewsRelated>
          )}
        </div>
      </div>
      <div>
        <img
          className="w-full pointer-events-none absolute h-full top-0 left-0"
          src="assets/images/news-page/bg-news-related.png"
          alt=""
        />
      </div>
      <div className="flex place-content-center items-center absolute bottom-[5%] left-[43%]">
          <svg
            width="123"
            height="37"
            viewBox="0 0 123 37"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clip-path="url(#clip0_119_8719)">
              <path
                d="M59.0671 9.56431C60.3549 10.1532 61.2272 10.782 61.5026 12.5563C61.7739 10.782 62.6482 10.1532 63.9277 9.56431C67.4538 8.33018 68.9628 7.03358 69.0782 4.9243C69.1517 3.42178 68.3234 2.0538 67.1853 1.504C66.256 1.05785 64.8632 1.18071 64.0239 1.63785C62.9683 2.2103 62.9277 2.90836 62.8714 3.53916C62.8068 4.22074 63.3343 4.85703 63.7306 5.06775C64.9016 5.68345 65.8405 4.98264 65.8405 4.98264C65.1455 4.89547 64.1764 4.03336 65.1255 3.07378C65.563 2.62625 67.2519 2.7752 67.1901 4.71083C67.1496 6.00742 66.6036 6.78168 64.8989 7.5621C61.8982 8.93283 61.6029 10.1258 61.5019 10.504C61.3996 10.1258 61.0967 8.93283 58.1049 7.5621C56.394 6.78099 55.8501 6.00674 55.8102 4.71083C55.7484 2.77589 57.4414 2.62625 57.8693 3.07378C58.8226 4.03336 57.8549 4.89547 57.1585 4.98264C57.1585 4.98264 58.0987 5.68345 59.2684 5.06775C59.6708 4.85634 60.1873 4.22074 60.1276 3.53916C60.0726 2.90905 60.03 2.2103 58.9751 1.63785C58.1392 1.18071 56.7422 1.05716 55.8157 1.50332C54.6784 2.0538 53.8487 3.4211 53.927 4.92361C54.0314 7.03358 55.5479 8.33018 59.0671 9.56431ZM122.327 4.41499C121.207 2.39425 117.833 1.1862 114.83 1.84102C110.81 2.70725 108.986 5.88387 107.004 11.0881C107.467 9.17307 107.193 7.083 105.846 5.72051C103.639 3.48562 100.711 3.26117 98.4842 4.51933C97.612 5.0149 97.0625 5.66354 96.7233 6.35954C96.2967 4.88792 95.4128 3.47258 93.9622 2.35993C90.8908 0.000115337 86.1044 -1.04938 81.1826 1.40447C77.5714 3.21037 75.5748 6.01429 72.0727 8.78388C66.392 13.2983 64.6551 14.4837 62.4744 14.925H61.5534H61.4428H60.5177C58.3405 14.4823 56.6049 13.2928 50.9242 8.78388C47.4283 6.01429 45.4269 3.21037 41.8143 1.40447C36.9001 -1.05007 32.1164 -0.00125735 29.0484 2.35925C27.5931 3.47189 26.7064 4.88723 26.2785 6.35405C25.9392 5.66011 25.3891 5.01421 24.5175 4.51864C22.2888 3.26048 19.3622 3.48493 17.1534 5.71983C15.7949 7.09124 15.5319 9.19572 16.0133 11.1224C14.025 5.89829 12.2056 2.70656 8.17056 1.84102C5.16848 1.1862 1.79415 2.39357 0.676696 4.41499C-0.242265 6.0795 -0.284848 8.8134 0.923263 10.3317C3.50707 13.5804 7.34225 12.1671 8.0119 10.7724C8.9027 8.91361 7.68635 7.1839 7.68635 7.1839C7.45764 7.39325 6.13277 9.76542 4.18221 7.73645C3.26874 6.79472 4.35529 3.77733 8.0744 4.06013C11.5662 4.32576 13.242 8.02473 15.0147 15.5867C15.9247 19.4978 16.8904 22.6984 18.5099 25.1578C19.8561 27.1957 21.8657 28.7758 24.0923 29.4923C31.0395 31.7176 35.5986 26.5759 37.5972 24.8242C42.2848 20.7237 46.2154 18.9205 50.429 19.493C54.0987 19.9913 55.699 22.2578 56.6846 24.505C57.7608 26.9596 57.5939 28.992 56.6248 31.1692C55.6598 33.3458 53.0973 35.0679 49.8487 34.3225C48.6673 34.0473 46.826 33.0245 46.3493 30.8226C45.9695 29.1066 46.5238 27.6707 47.9112 27.1627C51.1392 25.9904 52.2367 30.084 52.2367 30.084C52.2367 30.084 53.1234 28.9439 53.0492 27.6027C52.986 26.3384 52.0176 24.8921 50.394 24.0012C48.4297 22.9119 46.4008 23.6697 45.7573 24.0012C43.1707 25.3314 42.0657 28.7655 43.1804 31.8233C44.1763 34.5744 46.8672 36.1339 49.6103 36.7352C53.8473 37.6549 57.6488 36.0948 59.7656 33.4048C60.6681 32.253 61.2691 30.5885 61.5012 28.7929C61.7299 30.5885 62.3274 32.253 63.2292 33.4048C65.3494 36.0948 69.1524 37.6542 73.3845 36.7352C76.1325 36.1339 78.822 34.5744 79.82 31.8233C80.9278 28.7648 79.8262 25.3314 77.2492 24.0012C76.5981 23.6697 74.5693 22.9119 72.6077 24.0012C70.9834 24.8921 70.015 26.3384 69.9436 27.6027C69.879 28.9439 70.7616 30.084 70.7616 30.084C70.7616 30.084 71.8536 25.9904 75.094 27.1627C76.4704 27.6707 77.0281 29.1066 76.6476 30.8226C76.1771 33.0245 74.3316 34.0466 73.151 34.3225C69.901 35.0679 67.3398 33.3458 66.3701 31.1692C65.4058 28.992 65.2396 26.9596 66.3151 24.505C67.2986 22.2585 68.903 19.9913 72.572 19.493C76.7815 18.9205 80.7122 20.7244 85.4052 24.8242C87.4011 26.5759 91.9533 31.7176 98.9025 29.4923C101.129 28.7758 103.142 27.195 104.488 25.1578C106.104 22.6984 107.071 19.4978 107.988 15.5867C109.756 8.02473 111.433 4.32576 114.929 4.06013C118.644 3.77802 119.725 6.79472 118.812 7.73645C116.87 9.76542 115.54 7.39325 115.313 7.1839C115.313 7.1839 114.098 8.91361 114.985 10.7724C115.657 12.1671 119.497 13.5811 122.075 10.3317C123.282 8.8134 123.246 6.0795 122.327 4.41499ZM96.6978 10.7717C96.7336 10.6522 96.7473 10.5294 96.7809 10.4079C98.1092 6.42475 101.436 7.26352 102.433 8.31508C103.194 9.11747 102.974 10.97 102.331 11.8575C100.919 13.7959 99.3771 14.6155 92.7342 14.9731L91.2885 14.9717C91.4286 14.9491 91.5405 14.9532 91.6868 14.9244C93.921 14.494 95.8627 13.4774 96.6978 10.7717ZM20.5704 8.31508C21.5614 7.26696 24.8678 6.42887 26.2091 10.3646C26.2455 10.4992 26.2627 10.6392 26.3066 10.7717C27.1487 13.4768 29.0752 14.494 31.3122 14.9244C31.4585 14.9532 31.5656 14.9491 31.7091 14.9717L30.2607 14.9731C23.6219 14.6155 22.0813 13.7959 20.6658 11.8575C20.0285 10.97 19.81 9.11747 20.5704 8.31508ZM35.4269 22.5056C34.0553 23.5221 29.6748 27.241 24.9282 25.3232C21.9385 24.1165 19.3471 20.4107 17.5113 15.2483C17.2084 14.3897 16.9247 13.5852 16.6383 12.8048C16.7887 13.0862 16.9529 13.3601 17.1349 13.612C19.6335 17.0563 23.5923 17.731 29.5869 17.731H44.155C41.3054 18.6103 38.532 20.189 35.4269 22.5056ZM34.4427 14.9697C35.1206 14.8111 35.7174 14.5496 36.3012 14.1652C37.2758 13.5399 38.1158 12.1287 37.8019 10.6529C37.2882 8.18329 34.9173 7.89569 34.9173 7.89569C35.5608 9.00559 35.5018 11.6214 32.5821 11.3606C30.5285 11.1766 29.2256 8.13044 32.6288 5.227C35.828 2.49927 40.8108 4.49118 46.1996 9.11129C48.6447 11.2062 53.1969 14.3505 57.2223 14.9312L34.4427 14.9697ZM62.2347 22.9098C61.8687 23.7527 61.6283 24.6691 61.5033 25.6067C61.3741 24.6698 61.1344 23.7527 60.7691 22.9098C59.6502 20.3599 57.2065 18.6528 54.5815 17.731H68.4181C65.7917 18.6528 63.3494 20.3599 62.2347 22.9098ZM65.7863 14.9305C69.8028 14.3492 74.3619 11.2048 76.7987 9.11061C82.1923 4.4905 87.1703 2.49858 90.3688 5.22631C93.7761 8.13044 92.4712 11.1766 90.4238 11.3599C87.4959 11.6207 87.445 9.0049 88.0831 7.895C88.0831 7.895 85.7163 8.18329 85.1984 10.6522C84.8921 12.128 85.728 13.5392 86.6936 14.1645C87.2816 14.5489 87.8812 14.8104 88.5563 14.969L65.7863 14.9305ZM105.485 15.249C103.657 20.4114 101.063 24.1172 98.0742 25.3239C93.3159 27.2417 88.9409 23.5228 87.5714 22.5062C84.4649 20.1897 81.6957 18.611 78.842 17.7317H93.41C99.406 17.7317 103.366 17.057 105.872 13.6127C106.054 13.3697 106.203 13.1061 106.348 12.835C106.069 13.6079 105.784 14.402 105.485 15.249ZM32.6824 33.516C25.9062 35.7481 16.7386 33.8606 11.8368 33.5421C5.40818 33.1227 1.89992 35.7976 1.89992 35.7976C1.89992 35.7976 3.31613 31.2886 11.1671 31.2399C17.0621 31.1994 20.6466 33.4171 28.6487 32.8179C36.6487 32.2125 41.0155 25.5545 41.0155 25.5545C41.0155 25.5545 39.4626 31.2852 32.6824 33.516ZM81.9862 25.5545C81.9862 25.5545 86.3585 32.2125 94.3544 32.8186C102.359 33.4178 105.943 31.2008 111.833 31.2406C119.681 31.2886 121.105 35.7982 121.105 35.7982C121.105 35.7982 117.599 33.1234 111.17 33.5428C106.267 33.8612 97.0989 35.7488 90.3207 33.5167C83.5501 31.2852 81.9862 25.5545 81.9862 25.5545Z"
                fill="#9E2B25"
              />
            </g>
            <defs>
              <clipPath id="clip0_119_8719">
                <rect width="123" height="37" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </div>
    </div>
  );
};

export default NewsRelated;
